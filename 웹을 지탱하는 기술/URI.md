### URI 구문

URI는 Uniform Resource Identifier의 줄임말로 유니폼 리소스 식별자란 뜻이다. 즉, URI는 리소스를 통일적으로 식별하는 ID를 의미한다. URI만 있으면 모든 리소스에 간단히 접속할 수 있다. `http://blog.example.com/entries/1` 를 예를 들면

- **URI Scheme**: http
- **호스트 명**: [blog.example.com](http://blog.example.com)
- **path**: /entries/1

URI는 스키마로 시작되며 URI 스키마는 그 URI가 이용하는 프로토콜을 나타내는게 일반적이다. 위의 예에선 http로 리소스에 접근이 가능하단 뜻이다. 호스트명은 DNS에서 이름을 해석할 수 있는 도메인 명이나 IP주소로 인터넷에서 반드시 일의성을 가지게된다.

`http://tony:pass@blog.example.com:8000/search?q=test&debug=true#n10` 좀 복잡한 URI를 예로 들면

- **URI Scheme**: http
- **사용자 정보**: tony:pass
- **호스트 명**: [blog.example.com](http://blog.example.com)
- **포트번호**: 8000
- **패스**: /search
- **쿼리 파라미터**: q=test&debug=true
- **URI Fragment**: #n10

사용자 이름과 패스워드는 `:`로 구분합니다. 호스트 정보는 호스트명과 포트번호로 구성되며 역시 `:`로 구분됩니다. 패스 뒤에 `?`가 오고 `이름=값`의 형태로 쿼리가 들어옵니다. 쿼리의 연결은 `&`로 합니다. 마지막 `#`으로 시작하는 문자열은 `URI Fragment`입니다.

### 절대 URI와 상대 URI

OS의 파일 시스템에서 루트에서 전체 경로를 기술한 것을 절대 경로라 합니다. 파일 시스템 경우 매번 절대 경로를 기술하면 길어지기 때문에 파일의 위치를 지정할 때는 현재 디렉터리에서 상대 경로로 나타내는 것이 일반적이다. OS 파일 시스템처럼 URI에도 절대 URI, 상대 URI가 있고 상대 URI는 URI 스키마와 호스트명을 생략하고 경로만으로 표현한다. 아래 예시를 들겠다.

절대 URI: `http://example.com/foo/bar`

|상대 경로|절대 경로|
|---|---|
|hoge|/foo/bar/hoge|
|hoge/fuga|/foo/bar/hoge/fuga|
|./hoge|/foo/bar/hoge|
|../hoge|/foo/hoge|

### URI 구현에 주의할 점

웹 서비스를 구현함에 있어 URI의 스펙상 주의할 점은 `상대 URI 해석`과 `%인코딩`을 다루는 2가지다. 클라이언트에서 상대 URI를 해석하기 위해서는 번거로운 처리가 필요하기에 웹 서비스와 웹 API를 구현할 땐 가능한 절대 URI를 사용해야 클라이언트에게 도움이 된다.

또한, URI에 ASCII 이외의 문자를 넣을 경우에 문자 인코딩의 혼란을 피하기 위해 %인코딩의 문자 인코딩으로 될 수 있는 한 UTF-8을 이용해야한다.

## URI의 설계

웹의 발명자 팀 버너스 리는 _**“URI는 변하지 않아야 한다. 변하지 않는 URI가 최고의 URI다”**_ 라고 말했다. 이렇게 말한 이유는 웹은 리스에서 다른 리소스가 연결되는 링크가 들어있는 하이퍼미디어 시스템인데 북마크나 저장한 URI가 변하여 404페이지를 노출하는 건 하이퍼미디어 시스템이 동작하지 않는단 거다. 변하지 않는 URI를 설계하는 것에 대해 알아보자.

**- 프로그래밍 언어에 의존적인 확장자와 경로를 포함하지 않는다** 먼저 개발자만 알고 있는 프로그래밍 언어에 의존적인 부분을 배제하는거다. 아래 예시를 보면 `http://example.com/servlet/LoginServlet` 확장자가 `.java` 가 없는건 좋지만 경로인 servlet은 특정 서블릿 컨테이너의 기본 경로이고 시스템을 서블릿에서 PHP로 바꾸면 변경된다. 이처럼 특정 언어에 의존하는 문자열이 URI에 포함되면 그 언어가 변경되면 그 URI도 사용을 못하게된다.

**- 메서드명과 세션ID를 포함하지 않는다** `http://example.com/Login.do?action=showPage` 여기선 `.do` 라는 확장자도 문제이지미나 showPage란 메서드명이 URI에 포함되어있다는 점이 문제다. 시스템을 변경해 메서드명이 변경되면 URI가 변하기 때문이다. `http://example.com/home.jsp?jsessionid=123` 세션 인증 로그인을 구현할 때 쿠키가 아니라 URI에 집어 넣으면 세션 아이디 파라미터를 포함하는 URI가 생성된다. 하지만 이 세션ID는 유효시간이 지나고 다시 로그인을 하면 계속 바뀌게 되니 URI가 계속 변하는 문제가 있다.

### URI 강하게 의식하기

URI는 아래와 같은 이유로 아주 중요하다.

- URI는 리소스의 이름이다.
- URI는 수명이 길다.
- URI는 브라우저가 주소 란에 표시한다.

이런 이유로 URI는 웹 서비스와 웹 API 설계에 있어 가장 중요시해야하는 부분 중 하나이다.